# =============================================================================
# Eleanor OVA Configuration Template
# =============================================================================
# This file is used by first-run-setup.sh to generate .env
# Placeholders are replaced with actual values during setup
#
# Placeholder format:
#   __GENERATE__  - Generate secure random value
#   __PROMPT__    - Prompt user for value
#   __DETECT__    - Auto-detect from system
# =============================================================================

# =============================================================================
# Core Settings
# =============================================================================
ELEANOR_HOSTNAME=__PROMPT__
SECRET_KEY=__GENERATE__

# =============================================================================
# Database
# =============================================================================
POSTGRES_PASSWORD=__GENERATE__
DATABASE_URL=postgresql://eleanor:${POSTGRES_PASSWORD}@postgres:5432/eleanor

# =============================================================================
# Elasticsearch
# =============================================================================
ELASTICSEARCH_URL=http://elasticsearch:9200
ES_JAVA_OPTS=-Xms__DETECT__g -Xmx__DETECT__g

# =============================================================================
# Redis
# =============================================================================
REDIS_URL=redis://redis:6379
REDIS_PASSWORD=__GENERATE__

# =============================================================================
# Security
# =============================================================================
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=60
CORS_ORIGINS=https://${ELEANOR_HOSTNAME}

# =============================================================================
# Application
# =============================================================================
DEBUG=false
LOG_LEVEL=INFO
EVIDENCE_PATH=/app/evidence

# Encryption key for evidence at rest
EVIDENCE_ENCRYPTION_KEY=__GENERATE__

# =============================================================================
# Authentication
# =============================================================================

# Local accounts (SAM - Security Account Manager)
SAM_ENABLED=true
SAM_ALLOW_REGISTRATION=false

# Initial admin account (created on first run)
ADMIN_USERNAME=__PROMPT__
ADMIN_PASSWORD=__PROMPT__
ADMIN_EMAIL=__PROMPT__

# OIDC / OAuth2 (Azure AD, Okta, Keycloak)
OIDC_ENABLED=false
OIDC_ISSUER=
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=
OIDC_REDIRECT_URI=https://${ELEANOR_HOSTNAME}/auth/callback

# LDAP / Active Directory
LDAP_ENABLED=false
LDAP_SERVER=ldap://dc.example.com
LDAP_BASE_DN=DC=example,DC=com
LDAP_BIND_DN=
LDAP_BIND_PASSWORD=
LDAP_USER_FILTER=(sAMAccountName={username})
LDAP_GROUP_FILTER=(member={user_dn})
LDAP_ADMIN_GROUP=CN=Eleanor-Admins,OU=Groups,DC=example,DC=com
LDAP_ANALYST_GROUP=CN=Eleanor-Analysts,OU=Groups,DC=example,DC=com

# =============================================================================
# Email Notifications
# =============================================================================
SMTP_ENABLED=false
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=eleanor@${ELEANOR_HOSTNAME}
SMTP_TLS=true

# =============================================================================
# Integrations
# =============================================================================

# -----------------------------------------------------------------------------
# Velociraptor - Endpoint Collection
# https://www.velocidex.com/
# -----------------------------------------------------------------------------
VELOCIRAPTOR_ENABLED=false
VELOCIRAPTOR_URL=https://velociraptor:8003
VELOCIRAPTOR_API_KEY=
VELOCIRAPTOR_VERIFY_SSL=false
# For mutual TLS authentication
VELOCIRAPTOR_CLIENT_CERT=
VELOCIRAPTOR_CLIENT_KEY=

# -----------------------------------------------------------------------------
# IRIS - Case Management
# https://dfir-iris.org/
# -----------------------------------------------------------------------------
IRIS_ENABLED=false
IRIS_URL=https://iris:8443
IRIS_API_KEY=
IRIS_VERIFY_SSL=false

# IRIS internal configuration (if running embedded)
IRIS_DB_PASSWORD=__GENERATE__
IRIS_SECRET_KEY=__GENERATE__
IRIS_PASSWORD_SALT=__GENERATE__
IRIS_ADMIN_PASSWORD=__GENERATE__

# -----------------------------------------------------------------------------
# OpenCTI - Threat Intelligence Platform
# https://www.opencti.io/
# -----------------------------------------------------------------------------
OPENCTI_ENABLED=false
OPENCTI_URL=http://opencti:8080
OPENCTI_API_KEY=
OPENCTI_VERIFY_SSL=false

# OpenCTI internal configuration (if running embedded)
OPENCTI_ADMIN_EMAIL=${ADMIN_EMAIL}
OPENCTI_ADMIN_PASSWORD=__GENERATE__
OPENCTI_ADMIN_TOKEN=__GENERATE__
OPENCTI_MINIO_USER=__GENERATE__
OPENCTI_MINIO_PASSWORD=__GENERATE__
OPENCTI_RABBITMQ_USER=opencti_rmq
OPENCTI_RABBITMQ_PASSWORD=__GENERATE__

# -----------------------------------------------------------------------------
# Shuffle - SOAR / Workflow Automation
# https://shuffler.io/
# -----------------------------------------------------------------------------
SHUFFLE_ENABLED=false
SHUFFLE_URL=http://shuffle:3001
SHUFFLE_API_KEY=
SHUFFLE_VERIFY_SSL=false

# Shuffle internal configuration (if running embedded)
SHUFFLE_ADMIN_USER=${ADMIN_USERNAME}
SHUFFLE_ADMIN_PASSWORD=__GENERATE__

# -----------------------------------------------------------------------------
# Timesketch - Timeline Analysis
# https://timesketch.org/
# -----------------------------------------------------------------------------
TIMESKETCH_ENABLED=false
TIMESKETCH_URL=http://timesketch:5000
TIMESKETCH_USERNAME=
TIMESKETCH_PASSWORD=
TIMESKETCH_VERIFY_SSL=false

# Timesketch internal configuration (if running embedded)
TIMESKETCH_DB_PASSWORD=__GENERATE__
TIMESKETCH_SECRET_KEY=__GENERATE__

# =============================================================================
# Advanced Settings
# =============================================================================

# Session settings
SESSION_TIMEOUT_MINUTES=480
MAX_CONCURRENT_SESSIONS=5

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# Audit logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=365

# Evidence settings
MAX_UPLOAD_SIZE_MB=10240
ALLOWED_EVIDENCE_EXTENSIONS=.zip,.7z,.tar,.gz,.raw,.dd,.E01,.vmdk,.ova,.evtx,.pcap,.pcapng

# Search settings
SEARCH_MAX_RESULTS=10000
SEARCH_TIMEOUT_SECONDS=30

# =============================================================================
# Monitoring
# =============================================================================
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Health check endpoints (no auth required)
HEALTH_CHECK_ENABLED=true
