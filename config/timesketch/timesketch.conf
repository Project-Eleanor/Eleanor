# Timesketch Configuration for Eleanor Integration
# Reference: https://github.com/google/timesketch/blob/master/data/timesketch.conf

# Secret key for session management (CHANGE THIS)
SECRET_KEY = 'REPLACE_WITH_SECRET_KEY'

# Elasticsearch configuration
ELASTIC_HOST = 'elasticsearch'
ELASTIC_PORT = 9200

# Redis configuration
REDIS_HOST = 'redis'
REDIS_PORT = 6379

# PostgreSQL configuration
POSTGRES_HOST = 'postgres'
POSTGRES_PORT = 5432
POSTGRES_USER = 'timesketch'
POSTGRES_PASSWORD = 'REPLACE_WITH_PASSWORD'
POSTGRES_DATABASE = 'timesketch'

# Upload settings
UPLOAD_ENABLED = True
UPLOAD_FOLDER = '/usr/share/timesketch/upload'

# CSRF protection
WTF_CSRF_ENABLED = True

# Session configuration
SESSION_TYPE = 'filesystem'

# Enable debug mode (set to False in production)
DEBUG = False

# Features
ENABLE_EXPERIMENTAL_UI = True
ENABLE_SIGMA_RULES = True

# Graph database (optional)
GRAPH_BACKEND_ENABLED = False

# Data finder settings
DATA_FINDER_PATH = '/usr/share/timesketch/data/finder'

# Celery configuration
CELERY_BROKER_URL = 'redis://redis:6379/0'
CELERY_RESULT_BACKEND = 'redis://redis:6379/0'

# OpenSearch/Elasticsearch index prefix
TIMESKETCH_INDEX_PREFIX = 'timesketch'

# Enable analyzers
ANALYZERS_ENABLED = True

# Auto-run analyzers after timeline is indexed
AUTO_RUN_ANALYZERS = False

# Maximum events to return in search
SEARCH_RESULT_LIMIT = 10000

# Authentication configuration (for Eleanor integration)
# Use local authentication or integrate with Eleanor's auth
SSO_ENABLED = False
