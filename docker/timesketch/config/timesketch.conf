# Timesketch Configuration for Eleanor Integration

# Secret key - CHANGE THIS
SECRET_KEY = 'timesketch_secret_key_change_me'

# Database configuration
SQLALCHEMY_DATABASE_URI = 'postgresql://timesketch:timesketch_db_password@timesketch-postgres:5432/timesketch'

# Elasticsearch/OpenSearch configuration
# Using Eleanor's shared Elasticsearch
OPENSEARCH_HOST = 'eleanor-elasticsearch'
OPENSEARCH_PORT = 9200

# If Elasticsearch requires auth, uncomment:
# OPENSEARCH_USER = ''
# OPENSEARCH_PASSWORD = ''

# Redis for Celery
CELERY_BROKER_URL = 'redis://timesketch-redis:6379/0'
CELERY_RESULT_BACKEND = 'redis://timesketch-redis:6379/0'

# Upload settings
UPLOAD_ENABLED = True
UPLOAD_FOLDER = '/usr/share/timesketch/upload'

# Maximum upload size (10GB)
MAX_CONTENT_LENGTH = 10737418240

# Features
ENABLE_EXPERIMENTAL_UI = True
SIGMA_RULES_FOLDERS = ['/etc/timesketch/sigma/rules']

# Graph backend (disable for now)
GRAPH_BACKEND_ENABLED = False

# Search result limits
SEARCH_RESULT_LIMIT = 10000

# Event export
CSV_EXPORT_SIZE_LIMIT = 50000

# Logging
LOG_LEVEL = 'INFO'

# Data finder
DATA_FINDER_ENABLED = True

# Aggregation settings
AGGREGATION_BUCKET_LIMIT = 1000

# Auto-analyzer settings
AUTO_SKETCH_ANALYZERS = []
AUTO_INDEX_ANALYZERS = []

# Authentication
# For integration with Eleanor, we can use basic auth or configure OIDC
SSO_ENABLED = False

# Session settings
SESSION_COOKIE_SECURE = False  # Set to True with HTTPS
PERMANENT_SESSION_LIFETIME = 86400

# CORS (if needed for Eleanor frontend integration)
CORS_ENABLED = True
CORS_ORIGINS = ['http://localhost:4200', 'http://10.150.150.50:8000']
